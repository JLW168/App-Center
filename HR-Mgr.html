<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Future Plan Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        @import url('https://rsms.me/inter/inter.css');
        html { font-family: 'Inter', sans-serif; }
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 0.5rem;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
        }
        /* Simple class for form inputs to reduce repetition */
        .input {
            margin-top: 0.25rem;
            display: block;
            width: 100%;
            padding-left: 0.75rem;
            padding-right: 0.75rem;
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
            border-width: 1px;
            border-color: #D1D5DB;
            border-radius: 0.375rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        .input:focus {
            outline: 2px solid transparent;
            outline-offset: 2px;
            --tw-ring-color: #2563EB;
            border-color: #2563EB;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="root"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, doc, addDoc, updateDoc, deleteDoc, setLogLevel, getDocs } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBNb5ZI9XIWWSpxGD-FeV94K5FMc2a8udU",
            authDomain: "hr-manager-84ada.firebaseapp.com",
            projectId: "hr-manager-84ada",
            storageBucket: "hr-manager-84ada.firebasestorage.app",
            messagingSenderId: "365563456537",
            appId: "1:365563456537:web:9c5a6fbce7710b4c72ce88",
            measurementId: "G-51R9KT7LC1"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        setLogLevel('debug');

        // Expose Firebase services and functions to the global window object
        window.db = db;
        window.auth = auth;
        window.onAuthStateChanged = onAuthStateChanged;
        window.collection = collection;
        window.onSnapshot = onSnapshot;
        window.doc = doc;
        window.addDoc = addDoc;
        window.updateDoc = updateDoc;
        window.deleteDoc = deleteDoc;
        window.getDocs = getDocs;


        signInAnonymously(auth).catch(error => {
            console.error("Anonymous sign-in failed:", error);
        });

    </script>

    <script type="text/babel">
        const { useState, useEffect, useMemo } = React;

        // Helper function to format date to DD-MM-YYYY
        const formatDate = (dateString) => {
            if (!dateString) return '';
            const [year, month, day] = dateString.split('-');
            return `${day}-${month}-${year}`;
        };

        // Helper function to format numbers with commas
        const formatCurrency = (number) => {
            if (number === null || number === undefined || number === '') return '';
            return Number(number).toLocaleString('en-US');
        };


        // Sidebar Component
        function Sidebar({ currentPage, setCurrentPage }) {
            const NavItem = ({ pageName, title, icon }) => (
                <button
                    onClick={() => setCurrentPage(pageName)}
                    className={`flex items-center w-full px-4 py-3 text-left transition-colors duration-200 rounded-lg ${
                        currentPage === pageName
                            ? 'bg-blue-600 text-white'
                            : 'text-gray-600 hover:bg-gray-200'
                    }`}
                >
                    <svg className="w-6 h-6 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">{icon}</svg>
                    <span className="font-medium">{title}</span>
                </button>
            );

            return (
                <div className="fixed top-0 left-0 h-full w-64 bg-white shadow-lg p-4 flex flex-col">
                    <div className="text-2xl font-bold text-gray-800 mb-10">HR Manager</div>
                    <nav className="flex flex-col space-y-2">
                        <NavItem pageName="employees" title="Employees" icon={<path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M15 21a6 6 0 00-9-5.197M15 11a3 3 0 11-6 0 3 3 0 016 0z" />} />
                        <NavItem pageName="employeeState" title="Employee State" icon={<path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z" />} />
                        <NavItem pageName="resignedTerminated" title="Resigned/Terminated" icon={<path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M13 7a4 4 0 11-8 0 4 4 0 018 0zM9 14a6 6 0 00-6 6v1h12v-1a6 6 0 00-6-6zm12-2h-6" />} />
                        <NavItem pageName="settings" title="Settings" icon={<><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" /></>} />
                    </nav>
                </div>
            );
        }

        // Main App Component
        function App() {
            const [currentPage, setCurrentPage] = useState('employees');
            const [shops, setShops] = useState([]);
            const [supervisors, setSupervisors] = useState([]);
            const [positions, setPositions] = useState([]);
            const [employees, setEmployees] = useState([]);
            const [employeeStates, setEmployeeStates] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [isAuthReady, setIsAuthReady] = useState(false);

            useEffect(() => {
                const unsubscribe = window.onAuthStateChanged(window.auth, user => {
                    if (user) setIsAuthReady(true);
                    else setIsAuthReady(false);
                });
                return () => unsubscribe();
            }, []);

            useEffect(() => {
                if (!isAuthReady) return;

                const setupInitialPositions = async () => {
                    const positionsCollection = window.collection(window.db, "positions");
                    const snapshot = await window.getDocs(positionsCollection);
                    if (snapshot.empty) {
                        const defaultPositions = ['CEO', 'Cashier', 'Sale', 'Security', 'Shop Manager', 'Transporter'];
                        for (const positionName of defaultPositions) {
                            await window.addDoc(positionsCollection, { name: positionName });
                        }
                    }
                };
                setupInitialPositions();

                const unsubscribers = [
                    window.onSnapshot(window.collection(window.db, "shops"), snapshot => setShops(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))), err => setError("Failed to load shops.")),
                    window.onSnapshot(window.collection(window.db, "supervisors"), snapshot => setSupervisors(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))), err => setError("Failed to load supervisors.")),
                    window.onSnapshot(window.collection(window.db, "positions"), snapshot => setPositions(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))), err => setError("Failed to load positions.")),
                    window.onSnapshot(window.collection(window.db, "employeeStates"), snapshot => setEmployeeStates(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))), err => setError("Failed to load employee states.")),
                    window.onSnapshot(window.collection(window.db, "employees"), snapshot => {
                        setEmployees(snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() })));
                        setLoading(false);
                    }, err => {
                        setError("Failed to load employees.");
                        setLoading(false);
                    })
                ];

                return () => unsubscribers.forEach(unsub => unsub());
            }, [isAuthReady]);

            return (
                <div className="flex">
                    <Sidebar currentPage={currentPage} setCurrentPage={setCurrentPage} />
                    <main className="flex-1 ml-64 p-4 sm:p-6 lg:p-8">
                        {error && <div className="bg-red-100 border-l-4 border-red-500 text-red-700 p-4 mb-6 rounded-md" role="alert"><p>{error}</p></div>}
                        
                        {loading ? (
                             <div className="flex justify-center items-center h-screen">
                                <div className="animate-spin rounded-full h-32 w-32 border-t-2 border-b-2 border-blue-600"></div>
                            </div>
                        ) : (
                            <div>
                                {currentPage === 'employees' && <EmployeePage employees={employees} shops={shops} positions={positions} supervisors={supervisors} />}
                                {currentPage === 'employeeState' && <EmployeeStatePage employeeStates={employeeStates} employees={employees} shops={shops} />}
                                {currentPage === 'resignedTerminated' && <ResignedTerminatedPage employees={employees} shops={shops} />}
                                {currentPage === 'settings' && <SettingsPage shops={shops} supervisors={supervisors} positions={positions} />}
                            </div>
                        )}
                    </main>
                </div>
            );
        }
        
        // ResignedTerminatedPage Component
        function ResignedTerminatedPage({ employees, shops }) {
            const resignedOrTerminatedEmployees = useMemo(() => {
                return employees.filter(emp => emp.staffStatus === 'Resigned' || emp.staffStatus === 'Terminated');
            }, [employees]);

            const getNameById = (id, list) => list.find(item => item.id === id)?.name || 'N/A';

            return (
                <div>
                    <header className="mb-8">
                        <h1 className="text-4xl font-bold text-gray-800">Resigned & Terminated Employees</h1>
                        <p className="text-gray-500 mt-1">A log of all former employees.</p>
                    </header>
                    <div className="bg-white shadow-md rounded-lg overflow-hidden">
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200">
                                <thead className="bg-gray-50">
                                    <tr>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Shop</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Join Date</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Staff Status</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Time Log</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Reason</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    {resignedOrTerminatedEmployees.length > 0 ? resignedOrTerminatedEmployees.map(emp => (
                                        <tr key={emp.id}>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{emp.name}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{getNameById(emp.shop, shops)}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{formatDate(emp.joinDate)}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{emp.staffStatus}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{formatDate(emp.statusChangeDate)}</td>
                                            <td className="px-6 py-4 text-sm text-gray-500">{emp.reason}</td>
                                        </tr>
                                    )) : (
                                        <tr><td colSpan="6" className="text-center py-10 text-gray-500">No resigned or terminated employees found.</td></tr>
                                    )}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        }


        // EmployeeStatePage Component
        function EmployeeStatePage({ employeeStates, employees, shops }) {
            const [formData, setFormData] = useState({
                date: new Date().toISOString().slice(0, 10),
                shopId: '',
                employeeId: '',
                statusState: 'Deduction',
                amount: '',
                note: ''
            });
            const [filteredEmployees, setFilteredEmployees] = useState([]);

            const handleShopChange = (e) => {
                const shopId = e.target.value;
                setFormData({
                    ...formData,
                    shopId: shopId,
                    employeeId: '' // Reset employee selection when shop changes
                });
                const employeesInShop = employees.filter(emp => emp.shop === shopId);
                setFilteredEmployees(employeesInShop);
            };

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                if (!formData.employeeId || !formData.shopId) {
                    alert("Please select a shop and an employee.");
                    return;
                }
                try {
                    await window.addDoc(window.collection(window.db, "employeeStates"), formData);
                    // Reset form
                    setFormData({
                        date: new Date().toISOString().slice(0, 10),
                        shopId: '',
                        employeeId: '',
                        statusState: 'Deduction',
                        amount: '',
                        note: ''
                    });
                    setFilteredEmployees([]);
                } catch (error) {
                    console.error("Error adding employee state: ", error);
                    alert("Failed to save employee state.");
                }
            };
            
            const getNameById = (id, list) => list.find(item => item.id === id)?.name || 'N/A';

            return (
                <div>
                    <header className="mb-8">
                        <h1 className="text-4xl font-bold text-gray-800">Employee State</h1>
                        <p className="text-gray-500 mt-1">Track employee deductions and engagements.</p>
                    </header>

                    <form onSubmit={handleSubmit} className="p-6 bg-white rounded-lg shadow-md mb-8 grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div><label className="block text-sm font-medium text-gray-700">Date</label><input type="date" name="date" value={formData.date} onChange={handleChange} className="input" required /></div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Shop</label>
                            <select name="shopId" value={formData.shopId} onChange={handleShopChange} className="input" required>
                                <option value="">Select Shop</option>
                                {shops.map(shop => <option key={shop.id} value={shop.id}>{shop.name}</option>)}
                            </select>
                        </div>
                        <div>
                            <label className="block text-sm font-medium text-gray-700">Staff Name</label>
                            <select name="employeeId" value={formData.employeeId} onChange={handleChange} className="input" required disabled={!formData.shopId}>
                                <option value="">Select Staff</option>
                                {filteredEmployees.map(emp => <option key={emp.id} value={emp.id}>{emp.name}</option>)}
                            </select>
                        </div>
                        <div><label className="block text-sm font-medium text-gray-700">Status State</label><select name="statusState" value={formData.statusState} onChange={handleChange} className="input"><option>Deduction</option><option>Engagement</option></select></div>
                        <div><label className="block text-sm font-medium text-gray-700">Amount (KHR)</label><input type="number" name="amount" value={formData.amount} onChange={handleChange} className="input" required /></div>
                        <div className="md:col-span-2"><label className="block text-sm font-medium text-gray-700">Note</label><textarea name="note" value={formData.note} onChange={handleChange} rows="3" className="input"></textarea></div>
                        <div className="md:col-span-2 text-right"><button type="submit" className="bg-blue-600 text-white px-6 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors">Save Record</button></div>
                    </form>

                    <div className="bg-white shadow-md rounded-lg overflow-hidden">
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200">
                                <thead className="bg-gray-50">
                                    <tr>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Staff Name</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Shop</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status State</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Amount (KHR)</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Note</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    {employeeStates.map(state => (
                                        <tr key={state.id}>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{formatDate(state.date)}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{getNameById(state.employeeId, employees)}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{getNameById(state.shopId, shops)}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{state.statusState}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{formatCurrency(state.amount)}</td>
                                            <td className="px-6 py-4 text-sm text-gray-500">{state.note}</td>
                                        </tr>
                                    ))}
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            );
        }

        // Settings Page Component
        function SettingsPage({ shops, supervisors, positions }) {
            const [activeTab, setActiveTab] = useState('shops');
            
            const TabButton = ({ tabName, title }) => (
                <button
                    onClick={() => setActiveTab(tabName)}
                    className={`px-4 py-2 text-sm font-medium rounded-md transition-colors duration-200 ${
                        activeTab === tabName
                            ? 'bg-blue-600 text-white shadow-md'
                            : 'bg-white text-gray-700 hover:bg-gray-200'
                    }`}
                >
                    {title}
                </button>
            );

            return (
                <div>
                     <header className="mb-8">
                        <h1 className="text-4xl font-bold text-gray-800">Settings</h1>
                        <p className="text-gray-500 mt-1">Manage your shop, supervisor, and position details.</p>
                    </header>
                    <div className="mb-6">
                        <div className="flex space-x-2 bg-gray-200 p-1 rounded-lg">
                            <TabButton tabName="shops" title="Shop List" />
                            <TabButton tabName="supervisors" title="Supervisors" />
                            <TabButton tabName="positions" title="Positions" />
                        </div>
                    </div>
                    <div>
                        {activeTab === 'shops' && <ShopList shops={shops} />}
                        {activeTab === 'supervisors' && <SupervisorList supervisors={supervisors} shops={shops} />}
                        {activeTab === 'positions' && <PositionList positions={positions} />}
                    </div>
                </div>
            )
        }

        // Employee Page Component
        function EmployeePage({ employees, shops, positions, supervisors }) {
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [editingEmployee, setEditingEmployee] = useState(null);
            const [filters, setFilters] = useState({ shop: '', name: '', joinDate: '', status: '' });

            const openModal = (employee = null) => {
                setEditingEmployee(employee);
                setIsModalOpen(true);
            };
            const closeModal = () => {
                setIsModalOpen(false);
                setEditingEmployee(null);
            };

            const handleFilterChange = (e) => {
                const { name, value } = e.target;
                setFilters(prev => ({ ...prev, [name]: value }));
            };
            
            const filteredEmployees = useMemo(() => {
                return employees.filter(emp => {
                    const shopMatch = filters.shop ? emp.shop === filters.shop : true;
                    const nameMatch = filters.name ? emp.name.toLowerCase().includes(filters.name.toLowerCase()) : true;
                    const dateMatch = filters.joinDate ? emp.joinDate === filters.joinDate : true;
                    const statusMatch = filters.status ? emp.staffStatus === filters.status : true;
                    return shopMatch && nameMatch && dateMatch && statusMatch;
                });
            }, [employees, filters]);


            return (
                <div>
                    <header className="mb-8">
                        <h1 className="text-4xl font-bold text-gray-800">Employee Management</h1>
                        <p className="text-gray-500 mt-1">Add, edit, and manage your employee records.</p>
                    </header>
                    <div className="flex justify-between items-center mb-4">
                        <h2 className="text-2xl font-semibold text-gray-700">Employees</h2>
                        <button onClick={() => openModal()} className="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors">
                            Add Employee
                        </button>
                    </div>

                    {/* Filter Section */}
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 p-4 bg-white rounded-lg shadow">
                         <select name="shop" value={filters.shop} onChange={handleFilterChange} className="input">
                            <option value="">All Shops</option>
                            {shops.map(s => <option key={s.id} value={s.id}>{s.name}</option>)}
                        </select>
                        <input type="text" name="name" placeholder="Filter by Name..." value={filters.name} onChange={handleFilterChange} className="input" />
                        <input type="date" name="joinDate" value={filters.joinDate} onChange={handleFilterChange} className="input" />
                        <select name="status" value={filters.status} onChange={handleFilterChange} className="input">
                            <option value="">All Statuses</option>
                            <option value="Active">Active</option>
                            <option value="Resigned">Resigned</option>
                            <option value="Terminated">Terminated</option>
                        </select>
                    </div>

                    <EmployeeHistoryTable employees={filteredEmployees} onEdit={openModal} shops={shops} positions={positions} supervisors={supervisors} />
                    {isModalOpen && <EmployeeModal employee={editingEmployee} onClose={closeModal} shops={shops} positions={positions} supervisors={supervisors} />}
                </div>
            );
        }

        // EmployeeHistoryTable Component
        function EmployeeHistoryTable({ employees, onEdit, shops, positions, supervisors }) {
            const handleDelete = async (id) => {
                const userConfirmed = await showConfirmation("Are you sure you want to delete this employee?");
                if (userConfirmed) {
                    try {
                        await window.deleteDoc(window.doc(window.db, "employees", id));
                    } catch (e) {
                        console.error("Error deleting document: ", e);
                        alert("Failed to delete employee.");
                    }
                }
            };
            
            const getNameById = (id, list) => list.find(item => item.id === id)?.name || 'N/A';

            return (
                <div className="bg-white shadow-md rounded-lg overflow-hidden">
                    <div className="overflow-x-auto">
                        <table className="min-w-full divide-y divide-gray-200">
                            <thead className="bg-gray-50">
                                <tr>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Shop</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Position</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Join Date</th>
                                    <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                </tr>
                            </thead>
                            <tbody className="bg-white divide-y divide-gray-200">
                                {employees.length > 0 ? employees.map(emp => (
                                    <tr key={emp.id}>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{emp.name}</td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{getNameById(emp.shop, shops)}</td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{getNameById(emp.position, positions)}</td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{formatDate(emp.joinDate)}</td>
                                        <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{emp.staffStatus}</td>
                                        <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                            <button onClick={() => onEdit(emp)} className="text-indigo-600 hover:text-indigo-900 mr-4">Edit</button>
                                            <button onClick={() => handleDelete(emp.id)} className="text-red-600 hover:text-red-900">Delete</button>
                                        </td>
                                    </tr>
                                )) : (
                                    <tr><td colSpan="6" className="text-center py-10 text-gray-500">No employees found.</td></tr>
                                )}
                            </tbody>
                        </table>
                    </div>
                </div>
            );
        }

        // EmployeeModal Component
        function EmployeeModal({ employee, onClose, shops, positions, supervisors }) {
            const [formData, setFormData] = useState({
                name: employee?.name || '',
                sex: employee?.sex || 'Male',
                nationalId: employee?.nationalId || '',
                telNo: employee?.telNo || '',
                shop: employee?.shop || '',
                position: employee?.position || '',
                shift: employee?.shift || 'AM',
                joinDate: employee?.joinDate || '',
                baseSalary: employee?.baseSalary || '',
                supervisor: employee?.supervisor || '',
                staffStatus: employee?.staffStatus || 'Active',
                address: employee?.address || '',
                note: employee?.note || '',
                statusChangeDate: employee?.statusChangeDate || null,
                reason: employee?.reason || ''
            });
            const [isSaving, setIsSaving] = useState(false);

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsSaving(true);
                
                let dataToSave = { ...formData };
                
                if ((dataToSave.staffStatus === 'Resigned' || dataToSave.staffStatus === 'Terminated') && employee?.staffStatus === 'Active') {
                    dataToSave.statusChangeDate = new Date().toISOString().slice(0, 10);
                }

                try {
                    if (employee) {
                        await window.updateDoc(window.doc(window.db, "employees", employee.id), dataToSave);
                    } else {
                        await window.addDoc(window.collection(window.db, "employees"), dataToSave);
                    }
                    onClose();
                } catch (err) {
                    console.error("Error saving employee:", err);
                    alert("Failed to save employee.");
                } finally {
                    setIsSaving(false);
                }
            };

            return (
                <div className="modal-overlay">
                    <div className="modal-content">
                        <h3 className="text-xl font-semibold mb-4">{employee ? 'Edit Employee' : 'Add New Employee'}</h3>
                        <form onSubmit={handleSubmit} className="grid grid-cols-1 md:grid-cols-2 gap-4">
                            {/* Form Fields */}
                            <div><label className="block text-sm font-medium text-gray-700">Name</label><input type="text" name="name" value={formData.name} onChange={handleChange} className="input" required /></div>
                            <div><label className="block text-sm font-medium text-gray-700">Sex</label><select name="sex" value={formData.sex} onChange={handleChange} className="input"><option>Male</option><option>Female</option></select></div>
                            <div><label className="block text-sm font-medium text-gray-700">National ID</label><input type="text" name="nationalId" value={formData.nationalId} onChange={handleChange} className="input" /></div>
                            <div><label className="block text-sm font-medium text-gray-700">Tel No.</label><input type="text" name="telNo" value={formData.telNo} onChange={handleChange} className="input" required /></div>
                            <div><label className="block text-sm font-medium text-gray-700">Shop</label><select name="shop" value={formData.shop} onChange={handleChange} className="input" required><option value="">Select Shop</option>{shops.map(s => <option key={s.id} value={s.id}>{s.name}</option>)}</select></div>
                            <div><label className="block text-sm font-medium text-gray-700">Position</label><select name="position" value={formData.position} onChange={handleChange} className="input" required><option value="">Select Position</option>{positions.map(p => <option key={p.id} value={p.id}>{p.name}</option>)}</select></div>
                            <div><label className="block text-sm font-medium text-gray-700">Shift</label><select name="shift" value={formData.shift} onChange={handleChange} className="input"><option>AM</option><option>PM</option></select></div>
                            <div><label className="block text-sm font-medium text-gray-700">Join Date</label><input type="date" name="joinDate" value={formData.joinDate} onChange={handleChange} className="input" required /></div>
                            <div><label className="block text-sm font-medium text-gray-700">Base Salary</label><input type="number" name="baseSalary" value={formData.baseSalary} onChange={handleChange} className="input" /></div>
                            <div><label className="block text-sm font-medium text-gray-700">Supervisor</label><select name="supervisor" value={formData.supervisor} onChange={handleChange} className="input"><option value="">Select Supervisor</option>{supervisors.map(s => <option key={s.id} value={s.id}>{s.name}</option>)}</select></div>
                            <div><label className="block text-sm font-medium text-gray-700">Staff Status</label><select name="staffStatus" value={formData.staffStatus} onChange={handleChange} className="input"><option>Active</option><option>Resigned</option><option>Terminated</option></select></div>
                            
                            {(formData.staffStatus === 'Resigned' || formData.staffStatus === 'Terminated') && (
                                <div className="md:col-span-2"><label className="block text-sm font-medium text-gray-700">Reason</label><textarea name="reason" value={formData.reason} onChange={handleChange} rows="2" className="input"></textarea></div>
                            )}

                            <div className="md:col-span-2"><label className="block text-sm font-medium text-gray-700">Address</label><textarea name="address" value={formData.address} onChange={handleChange} rows="2" className="input"></textarea></div>
                            <div className="md:col-span-2"><label className="block text-sm font-medium text-gray-700">Note</label><textarea name="note" value={formData.note} onChange={handleChange} rows="2" className="input"></textarea></div>
                            
                            <div className="md:col-span-2 mt-6 flex justify-end space-x-3">
                                <button type="button" onClick={onClose} className="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</button>
                                <button type="submit" disabled={isSaving} className="bg-blue-600 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-blue-700 disabled:bg-blue-300">{isSaving ? 'Saving...' : 'Save'}</button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        // ShopList, ShopModal, SupervisorList, SupervisorModal, PositionList, PositionModal components...
        // ... (These components remain the same as the previous version)
        // NOTE: For brevity, the unchanged components are omitted here but are included in the full running code.
        // The following are the definitions for the components that were omitted for brevity.

        // ShopList Component
        function ShopList({ shops }) {
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [editingShop, setEditingShop] = useState(null);

            const openModal = (shop = null) => {
                setEditingShop(shop);
                setIsModalOpen(true);
            };

            const closeModal = () => {
                setIsModalOpen(false);
                setEditingShop(null);
            };

            const handleDelete = async (id) => {
                const userConfirmed = await showConfirmation("Are you sure you want to delete this shop?");
                if (userConfirmed) {
                    try {
                        await window.deleteDoc(window.doc(window.db, "shops", id));
                    } catch (e) {
                        console.error("Error deleting document: ", e);
                        alert("Failed to delete shop.");
                    }
                }
            };

            return (
                <div>
                    <div className="flex justify-between items-center mb-4">
                        <h2 className="text-2xl font-semibold text-gray-700">Shops</h2>
                        <button onClick={() => openModal()} className="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors">
                            Add Shop
                        </button>
                    </div>
                    <div className="bg-white shadow-md rounded-lg overflow-hidden">
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200">
                                <thead className="bg-gray-50">
                                    <tr>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Shop Name</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact No</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Address</th>
                                        <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    {shops.length > 0 ? shops.map(shop => (
                                        <tr key={shop.id}>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{shop.name}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{shop.contact}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{shop.address}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                <button onClick={() => openModal(shop)} className="text-indigo-600 hover:text-indigo-900 mr-4">Edit</button>
                                                <button onClick={() => handleDelete(shop.id)} className="text-red-600 hover:text-red-900">Delete</button>
                                            </td>
                                        </tr>
                                    )) : (
                                        <tr><td colSpan="4" className="text-center py-10 text-gray-500">No shops found.</td></tr>
                                    )}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    {isModalOpen && <ShopModal shop={editingShop} onClose={closeModal} />}
                </div>
            );
        }

        // ShopModal Component
        function ShopModal({ shop, onClose }) {
            const [name, setName] = useState(shop?.name || '');
            const [contact, setContact] = useState(shop?.contact || '');
            const [address, setAddress] = useState(shop?.address || '');
            const [isSaving, setIsSaving] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsSaving(true);
                const shopData = { name, contact, address };
                try {
                    if (shop) {
                        await window.updateDoc(window.doc(window.db, "shops", shop.id), shopData);
                    } else {
                        await window.addDoc(window.collection(window.db, "shops"), shopData);
                    }
                    onClose();
                } catch (e) {
                    console.error("Error saving document: ", e);
                    alert("Failed to save shop. Check console for details.");
                } finally {
                    setIsSaving(false);
                }
            };

            return (
                <div className="modal-overlay">
                    <div className="modal-content">
                        <h3 className="text-xl font-semibold mb-4">{shop ? 'Edit Shop' : 'Add New Shop'}</h3>
                        <form onSubmit={handleSubmit}>
                            <div className="space-y-4">
                                <div>
                                    <label htmlFor="shopName" className="block text-sm font-medium text-gray-700">Shop Name</label>
                                    <input type="text" id="shopName" value={name} onChange={e => setName(e.target.value)} className="input" required />
                                </div>
                                <div>
                                    <label htmlFor="contactNo" className="block text-sm font-medium text-gray-700">Contact No</label>
                                    <input type="text" id="contactNo" value={contact} onChange={e => setContact(e.target.value)} className="input" required />
                                </div>
                                <div>
                                    <label htmlFor="address" className="block text-sm font-medium text-gray-700">Address</label>
                                    <textarea id="address" value={address} onChange={e => setAddress(e.target.value)} rows="3" className="input" required></textarea>
                                </div>
                            </div>
                            <div className="mt-6 flex justify-end space-x-3">
                                <button type="button" onClick={onClose} className="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</button>
                                <button type="submit" disabled={isSaving} className="bg-blue-600 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-blue-700 disabled:bg-blue-300">
                                    {isSaving ? 'Saving...' : 'Save'}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        // SupervisorList Component
        function SupervisorList({ supervisors, shops }) {
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [editingSupervisor, setEditingSupervisor] = useState(null);

            const openModal = (supervisor = null) => {
                setEditingSupervisor(supervisor);
                setIsModalOpen(true);
            };

            const closeModal = () => {
                setIsModalOpen(false);
                setEditingSupervisor(null);
            };

            const handleDelete = async (id) => {
                const userConfirmed = await showConfirmation("Are you sure you want to delete this supervisor?");
                if (userConfirmed) {
                    try {
                        await window.deleteDoc(window.doc(window.db, "supervisors", id));
                    } catch (e) {
                        console.error("Error deleting document: ", e);
                        alert("Failed to delete supervisor.");
                    }
                }
            };
            
            const getShopNames = (shopIds) => {
                if (!shopIds || shopIds.length === 0) return 'No shops assigned';
                return shopIds.map(id => {
                    const shop = shops.find(s => s.id === id);
                    return shop ? shop.name : 'Unknown Shop';
                }).join(', ');
            };

            return (
                <div>
                    <div className="flex justify-between items-center mb-4">
                        <h2 className="text-2xl font-semibold text-gray-700">Supervisors</h2>
                        <button onClick={() => openModal()} className="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors">
                            Add Supervisor
                        </button>
                    </div>
                     <div className="bg-white shadow-md rounded-lg overflow-hidden">
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200">
                                <thead className="bg-gray-50">
                                    <tr>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Contact No</th>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Assigned Shops</th>
                                        <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    {supervisors.length > 0 ? supervisors.map(supervisor => (
                                        <tr key={supervisor.id}>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{supervisor.name}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{supervisor.contact}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-500">{getShopNames(supervisor.assignedShops)}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                <button onClick={() => openModal(supervisor)} className="text-indigo-600 hover:text-indigo-900 mr-4">Edit</button>
                                                <button onClick={() => handleDelete(supervisor.id)} className="text-red-600 hover:text-red-900">Delete</button>
                                            </td>
                                        </tr>
                                    )) : (
                                        <tr><td colSpan="4" className="text-center py-10 text-gray-500">No supervisors found.</td></tr>
                                    )}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    {isModalOpen && <SupervisorModal supervisor={editingSupervisor} shops={shops} onClose={closeModal} />}
                </div>
            );
        }

        // SupervisorModal Component
        function SupervisorModal({ supervisor, shops, onClose }) {
            const [name, setName] = useState(supervisor?.name || '');
            const [contact, setContact] = useState(supervisor?.contact || '');
            const [assignedShops, setAssignedShops] = useState(supervisor?.assignedShops || []);
            const [isSaving, setIsSaving] = useState(false);

            const handleShopSelection = (shopId) => {
                setAssignedShops(prev => 
                    prev.includes(shopId) ? prev.filter(id => id !== shopId) : [...prev, shopId]
                );
            };

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsSaving(true);
                const supervisorData = { name, contact, assignedShops };
                 try {
                    if (supervisor) {
                        await window.updateDoc(window.doc(window.db, "supervisors", supervisor.id), supervisorData);
                    } else {
                        await window.addDoc(window.collection(window.db, "supervisors"), supervisorData);
                    }
                    onClose();
                } catch (e) {
                    console.error("Error saving document: ", e);
                    alert("Failed to save supervisor. Check console for details.");
                } finally {
                    setIsSaving(false);
                }
            };

            return (
                 <div className="modal-overlay">
                    <div className="modal-content">
                        <h3 className="text-xl font-semibold mb-4">{supervisor ? 'Edit Supervisor' : 'Add New Supervisor'}</h3>
                        <form onSubmit={handleSubmit}>
                            <div className="space-y-4">
                                <div>
                                    <label htmlFor="supervisorName" className="block text-sm font-medium text-gray-700">Supervisor Name</label>
                                    <input type="text" id="supervisorName" value={name} onChange={e => setName(e.target.value)} className="input" required />
                                </div>
                                <div>
                                    <label htmlFor="supervisorContact" className="block text-sm font-medium text-gray-700">Contact No</label>
                                    <input type="text" id="supervisorContact" value={contact} onChange={e => setContact(e.target.value)} className="input" required />
                                </div>
                                <div>
                                    <label className="block text-sm font-medium text-gray-700">Assign Shops</label>
                                    <div className="mt-2 max-h-40 overflow-y-auto border border-gray-300 rounded-md p-2 space-y-2">
                                        {shops.length > 0 ? shops.map(shop => (
                                            <div key={shop.id} className="flex items-center">
                                                <input
                                                    id={`shop-${shop.id}`}
                                                    type="checkbox"
                                                    checked={assignedShops.includes(shop.id)}
                                                    onChange={() => handleShopSelection(shop.id)}
                                                    className="h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"
                                                />
                                                <label htmlFor={`shop-${shop.id}`} className="ml-3 text-sm text-gray-700">{shop.name}</label>
                                            </div>
                                        )) : <p className="text-sm text-gray-500">No shops available to assign.</p>}
                                    </div>
                                </div>
                            </div>
                            <div className="mt-6 flex justify-end space-x-3">
                                <button type="button" onClick={onClose} className="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</button>
                                <button type="submit" disabled={isSaving} className="bg-blue-600 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-blue-700 disabled:bg-blue-300">
                                    {isSaving ? 'Saving...' : 'Save'}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }
        
        // PositionList Component
        function PositionList({ positions }) {
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [editingPosition, setEditingPosition] = useState(null);

            const openModal = (position = null) => {
                setEditingPosition(position);
                setIsModalOpen(true);
            };

            const closeModal = () => {
                setIsModalOpen(false);
                setEditingPosition(null);
            };

            const handleDelete = async (id) => {
                const userConfirmed = await showConfirmation("Are you sure you want to delete this position?");
                if (userConfirmed) {
                    try {
                        await window.deleteDoc(window.doc(window.db, "positions", id));
                    } catch (e) {
                        console.error("Error deleting document: ", e);
                        alert("Failed to delete position.");
                    }
                }
            };

            return (
                <div>
                    <div className="flex justify-between items-center mb-4">
                        <h2 className="text-2xl font-semibold text-gray-700">Positions</h2>
                        <button onClick={() => openModal()} className="bg-blue-600 text-white px-4 py-2 rounded-lg shadow hover:bg-blue-700 transition-colors">
                            Add Position
                        </button>
                    </div>
                    <div className="bg-white shadow-md rounded-lg overflow-hidden">
                        <div className="overflow-x-auto">
                            <table className="min-w-full divide-y divide-gray-200">
                                <thead className="bg-gray-50">
                                    <tr>
                                        <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Position Name</th>
                                        <th className="px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody className="bg-white divide-y divide-gray-200">
                                    {positions.length > 0 ? positions.map(position => (
                                        <tr key={position.id}>
                                            <td className="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">{position.name}</td>
                                            <td className="px-6 py-4 whitespace-nowrap text-right text-sm font-medium">
                                                <button onClick={() => openModal(position)} className="text-indigo-600 hover:text-indigo-900 mr-4">Edit</button>
                                                <button onClick={() => handleDelete(position.id)} className="text-red-600 hover:text-red-900">Delete</button>
                                            </td>
                                        </tr>
                                    )) : (
                                        <tr><td colSpan="2" className="text-center py-10 text-gray-500">No positions found.</td></tr>
                                    )}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    {isModalOpen && <PositionModal position={editingPosition} onClose={closeModal} />}
                </div>
            );
        }

        // PositionModal Component
        function PositionModal({ position, onClose }) {
            const [name, setName] = useState(position?.name || '');
            const [isSaving, setIsSaving] = useState(false);

            const handleSubmit = async (e) => {
                e.preventDefault();
                setIsSaving(true);
                const positionData = { name };
                try {
                    if (position) {
                        await window.updateDoc(window.doc(window.db, "positions", position.id), positionData);
                    } else {
                        await window.addDoc(window.collection(window.db, "positions"), positionData);
                    }
                    onClose();
                } catch (e) {
                    console.error("Error saving document: ", e);
                    alert("Failed to save position.");
                } finally {
                    setIsSaving(false);
                }
            };

            return (
                <div className="modal-overlay">
                    <div className="modal-content">
                        <h3 className="text-xl font-semibold mb-4">{position ? 'Edit Position' : 'Add New Position'}</h3>
                        <form onSubmit={handleSubmit}>
                            <div className="space-y-4">
                                <div>
                                    <label htmlFor="positionName" className="block text-sm font-medium text-gray-700">Position Name</label>
                                    <input type="text" id="positionName" value={name} onChange={e => setName(e.target.value)} className="input" required />
                                </div>
                            </div>
                            <div className="mt-6 flex justify-end space-x-3">
                                <button type="button" onClick={onClose} className="bg-white py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 hover:bg-gray-50">Cancel</button>
                                <button type="submit" disabled={isSaving} className="bg-blue-600 py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white hover:bg-blue-700 disabled:bg-blue-300">
                                    {isSaving ? 'Saving...' : 'Save'}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            );
        }

        // A simple promise-based confirmation dialog to replace window.confirm
        function showConfirmation(message) {
            return new Promise((resolve) => {
                const confirmationBox = document.createElement('div');
                confirmationBox.className = 'modal-overlay';
                confirmationBox.innerHTML = `
                    <div class="modal-content text-center">
                        <p class="mb-4">${message}</p>
                        <div class="flex justify-center space-x-4">
                            <button id="confirm-yes" class="bg-red-600 text-white px-4 py-2 rounded-lg shadow hover:bg-red-700">Yes, delete</button>
                            <button id="confirm-no" class="bg-white px-4 py-2 border border-gray-300 rounded-md shadow-sm text-gray-700 hover:bg-gray-50">Cancel</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(confirmationBox);

                document.getElementById('confirm-yes').onclick = () => {
                    document.body.removeChild(confirmationBox);
                    resolve(true);
                };

                document.getElementById('confirm-no').onclick = () => {
                    document.body.removeChild(confirmationBox);
                    resolve(false);
                };
            });
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
